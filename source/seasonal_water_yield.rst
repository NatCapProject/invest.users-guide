Seasonal water yield model
==========================

Summary
-------

There is a high demand for tools estimating the effect of landscape
management on water supply service (e.g. for irrigation, domestic use,
hydropower production). While the InVEST annual water yield model
provides an estimate of total water yield for a catchment, many
applications require knowledge of seasonal flows, especially during the
dry season. This requires the understanding of hydrological processes in
a catchment, in particular the partitioning between quick flow
(occurring during or shortly after rain events) and baseflow (occurring
during dry weather). In highly seasonal climates, baseflow is likely to
provide greater value than the quick flow, unless significant storage
(e.g., a large reservoir) is available. The InVEST seasonal water yield
model seeks to provide guidance regarding the contribution of land
parcels to the generation of both baseflow and quick flow. The model
computes spatial indices that quantifies the relative contribution of a
parcel of land to the generation of both baseflow and quick flow.
Currently, there are no quantitative estimates of baseflow (only the
relative contributions of pixels); a separate tool is in development to
address this question.

Introduction: value attribution for individual parcels in a landscape
----------------------------------------------------------------------

Understanding the effect of landscape management on seasonal flow is of
critical importance for watershed management. The contribution of a
given parcel to streamflow depends on a number of environmental factors
including climate, soil, vegetation, slope, and position along the flow
path (determining if the pixel may receive water from upslope or if
water recharged may later be evapotranspired).

Water flowing across the landscape is either evaporated, transpired,
withdrawn by a well, or leaves the watershed as deep groundwater flow or
streamflow. If we consider an individual pixel, and its value with
respect to water yield, we can consider two approaches:

-  The first gives credit to the net amount of water generated on a
   pixel as equal to the incoming precipitation minus the losses to
   evapotranspiration on that pixel. In this scheme, it is possible for
   actual evapotranspiration to be greater than precipitation if water
   is supplied to the site from upgradient. Thus, the net generation
   could be negative. This approach pays no heed to the eventual
   disposition of that water generated on that pixel; that is, it does
   not consider whether the water actually shows up as streamflow or is
   evaporated or withdrawn somewhere along its path.

-  The second approach gives credit to the water from a parcel that
   actually shows up as streamflow. Thus, if a parcel generates water
   that is later evaporated, the contribution is considered to be nil.

The former approach puts greater emphasis on the land-use and land-cover
of a site, since the focus is on net generation from that pixel. It
accounts for the subsidy of water from upslope pixels, but does not
consider downgradient effects. It represents a potential to generate
streamflow (not an actual generation of flow).

The second approach puts more emphasis on the topographic position of a
pixel, as that will determine the potential for water generated on that
pixel to be consumed before becoming streamflow. It represents the
actual streamflow generated by a pixel. Since actual streamflow cannot
be less than zero, this approach, unlike the first, will result in
indices that are greater than or equal to zero.

We use these concepts to develop a set of three indices, one for
quickflow, one for recharge (which represents the ‘potential baseflow’),
and one for actual baseflow. Here, baseflow is defined as the generation
of streamflow with watershed residence times of months to years, while
quick flow represents the generation of streamflow with watershed
residence times of hours to days.

How it works
------------

*Quickflow* (QF) is calculated with a Curve Number (CN)-based approach. Monthly rain events cause precipitation to fall on the landscape. Soil and land cover properties determine how much of the rain runs off of the land surface quickly (producing quickflow) versus infiltrating into the soil (producing local recharge.) The Curve Number is a simple way of capturing these soil + land cover properties - higher values of CN have higher runoff potential (for example, clay soils and low vegetation cover), lower values are more likely to infiltrate (for example, sandy soils and dense vegetation cover.)

To calculate quickflow, we use the mean event depth, :math:`\frac{P_{i,m}}{n_{i,m}}` and assume an exponential
distribution of daily precipitation depths on days with rain,

.. math:: f\left( p \right) = \frac{1}{a_{i,m}}exp\left( - \frac{p}{a_{i,m}} \right)

Where :math:`a_{i,m} = \frac{P_{i,m}}{n_{m}}/25.4` and

-  :math:`a_{i,m}` is the mean rain depth on a rainy day at pixel
   *i* on month *m* [in],

-  :math:`n_{i,m}` is the number of events at pixel *i* in month *m*
   [-],

-  :math:`P_{i,m}` is the monthly precipitation for pixel *i* at month
   *m* [mm].

In the boundary case, a stream cell’s QF is set to the precipitation at
that cell

.. math:: \text{QF}_{stream,m} = \ P_{stream,m}

otherwise it can be shown from the exponential distribution that the
monthly runoff :math:`\text{QF}_{i,m}` is

.. math:: \text{QF}_{i,m} = n_{m} \times \left( \left( a_{i,m} - S_{i} \right)\exp\left( - \frac{0.2S_{i}}{a_{i,m}} \right) + \frac{S_{i}^{2}}{a_{i,m}}\exp\left( \frac{0.8S_{i}}{a_{i,m}} \right)E_{1}\left( \frac{S_{i}}{a_{i,m}} \right) \right) \times \left( 25.4\ \left\lbrack \frac{\text{mm}}{\text{in}} \right\rbrack \right)

[1]

where

-  :math:`S_{i} = \frac{1000}{\text{CN}_{i}} - 10` [in]

-  :math:`\text{CN}_{i}` is the curve number for pixel *i*
   [in:sup:`-1`], tabulated, a function of the local LULC, and soil type
   *(see Appendix I for a template of this table)*,

-  and :math:`E_{1}` is the exponential integral function,
   :math:`E_{1}(t) = \int_{1}^{\infty}{\frac{e^{- t}}{t}\text{dt}}`.

Thus the annual quick flow :math:`\text{QF}_{i}`, can be calculated from
the sum of monthly :math:`\text{QF}_{i,m}` values,

.. math:: \text{QF}_{i} = \sum_{m = 1}^{12}{QF_{i,m}}

[2]

Local recharge (L)
------------------

The *local* *recharge,* or potential contribution to baseflow, of a
pixel is computed from the local water balance. Precipitation that does not run off as quickflow, and is not evapotranspired by the vegetation on a pixel, can infiltrate the soil to become local recharge. Local recharge can be
negative if a pixel does not receive enough of its own water to satisfy its vegetation requirements (determined by its crop factor *Kc*), so it uses water generated upslope of the pixel as well (referred to as an "upslope subsidy".) The local recharge index is computed on an annual time scale, but uses values derived from monthly water budgets.

For a pixel *i*, the local recharge derived from the annual water budget
is (Figure 1):

.. math:: L_{i} = P_{i} - \text{QF}_{i} - \text{AET}_{i}

[3]

Where annual actual evapotranspiration AET is the sum of monthly AET:

.. math:: \text{AET}_{i} = \sum_{\text{months}}^{}\text{AET}_{i,m}

[4]

For each month, :math:`\text{AET}_{i,m}` is either limited by the demand
(potential evapotranspiration - PET) or by the available water:

.. math:: \text{AET}_{i,m} = min(\text{PET}_{i,m}\ ;\ P_{i,m} - \text{QF}_{i,m} + \alpha_{m}\beta_{i}L_{sum.avail,i})

[5]

Where :math:`\text{PET}_{i,m}` is the monthly potential
evapotranspiration,

.. math:: \text{PET}_{i,m} = K_{c,i,m} \times ET_{0,i,m}

[6]

:math:`L_{sum.avail,i}` is recursively defined by (Figure 2),

.. math:: L_{sum.avail,i} = \sum_{j \in \{ neighbor\ pixels\ draining\ to\ pixel\ i\}}^{}{p_{\text{ij}} \cdot \left( L_{avail,j} + L_{sum.avail,j} \right)}

[7]

where :math:`p_{\text{ij}}\  \in \lbrack 0,1\rbrack` is the proportion
of flow from cell *i* to *j*, and :math:`L_{avail,i}` is the available
recharge to a pixel, which is :math:`L_{i}` whenever :math:`L_{i}` is negative, and
a proportion :math:`\gamma` of :math:`L_{i}` when it is positive (see
below for definition of :math:`\gamma`):

.. math:: L_{avail,i}\  = min(\gamma L_{i},L_{i})

[8]

In the above:

-  :math:`P_{i}` and :math:`P_{i,m}` are the annual and monthly
   precipitation, respectively [mm]

-  :math:`\text{QF}_{i}` and :math:`\text{QF}_{i,m}` are the quickflow
   indices, defined above [mm]

-  :math:`ET_{0,i,m}` is the reference evapotranspiration for month m
   [mm]

-  :math:`K_{c,i,m}` is the monthly crop factor for the pixel’s LULC [-]

-  :math:`\alpha_{m}` is the fraction of upslope annual available
   recharge that is available in month m (default is 1/12)

-  :math:`\beta_{i}` is the fraction of the upgradient subsidy that is
   available for downgradient evapotranspiration (default is 1; see
   Appendix II for more insights)

-  γ is the fraction of pixel recharge that is available to downgradient
   pixels (default is 1)

Attribution of recharge
-----------------------

The total baseflow, Qb (in mm), is the average of the contributing local
recharges (negative or positive) in the catchment,

.. math:: Q_{b} = \frac{\sum_{k \in \left\{ \text{pixels in catchment} \right\}}^{}L_{k}}{n_{\text{pixels in catchment}}}

[9]

Attribution value to a pixel is the relative contribution of L to the
baseflow:

.. math:: V_{R,i} = \frac{L_{i}}{{Q_{b} \times n}_{\text{pixels in catchment}}}

[10]

.. figure:: ./seasonal_water_yield_images/fig1.png
   :align: left
   :figwidth: 200px

*Figure 1. Water balance at the pixel scale to compute the local
recharge (Eq. 3).*

|
|
|

.. figure:: ./seasonal_water_yield_images/fig2.png
   :align: left
   :figwidth: 200px

*Figure 2. Routing at the hillslope scale to compute actual
evapotranspiration (based on pixel’s climate variables and the upslope
contribution, see Eq. 5) and baseflow (based on B\ :sub:`sum`, the flow
actually reaching the stream, see Eq. 11-14)*

|
|

The baseflow index represents the actual contribution of a pixel to
baseflow (i.e. water that reaches the stream). If the local recharge is
negative, then the pixel did not contribute to baseflow so B is set to
zero. If the pixel contributed to groundwater recharge, then B is a
function of the amount of flow leaving the pixel and of the relative
contribution to recharge of this pixel.

For a parcel that is not adjacent to the stream channel, the cumulative
baseflow, :math:`B_{sum,i}`, is proportional to the cumulative baseflow
leaving the adjacent downgradient parcels minus the cumulative baseflow
that was generated on that same downgradient parcel (Figure 2):

.. math::
   B_{sum,i} = L_{sum,i}\sum_{j \in \{\text{cells to which cell i pours}\}}^{}\begin{Bmatrix}
   p_{\text{ij}}\left( 1 - \frac{L_{avail,j}}{L_{sum,j}} \right)\frac{B_{sum,j}}{L_{sum,j} - L_{j}}\ \text{if }j\text{ is a nonstream pixel} \\
   p_{\text{ij}}\ \text{if }j\text{ is a stream pixel} \\
   \end{Bmatrix}

[11]

At the watershed outlet (or at any parcel adjacent to the stream), the
sum of baseflow generation :math:`B_{sum,i}` over all upgradient parcels
is equal to the sum of local generation over the same parcels (because
there is no further opportunity for the slow flow to be consumed before
reaching the stream):

.. math:: B_{sum,outlet} = L_{sum,outlet}

[12]

where :math:`L_{sum,i}` is the cumulative upstream recharge defined by

.. math:: L_{sum,i} = L_{i} + \sum_{j,\ all\ pixels\ draining\ to\ pixel\ i}^{}{L_{sum,j} \cdot p_{\text{ji}}}

[13]

and the baseflow, :math:`B_{i}` can be directly derived from the
proportion of the cumulative baseflow leaving cell *i*, with respect to
the available recharge to the upstream cumulative recharge:

.. math:: B_{i} = max\left(B_{sum,i} \cdot \frac{L_{i}}{L_{sum,i}}, 0\right)

[14]


Data needs
----------

This section outlines the specific data used by the model. See the Appendix for additional information on data sources and pre-processing. Please consult the InVEST sample data (located in the folder where InVEST is installed, if you also chose to install sample data) for examples of all of these data inputs. This will help with file type, folder structure and table formatting. Note that all GIS inputs must be in the same projected coordinate system and in linear meter units.

**>>>>> Sorry, now I've broken the Data Needs table, working on it... <<<<<**

|
|

.. csv-table:: 
   :file: seasonal_water_yield_images/SWY_data_needs_table.csv
   :header-rows: 1
   :name: Data needs

|


Advanced model options
----------------------

One model input is the number of rain events per month, which is entered
as a .csv table with one number for each month of the year. This assumes
that there is one such number for the whole watershed, which may not be
true for large areas or areas with very spatially variable precipitation.

To represent variability in the number of rain events, it is possible to
enter a map of climate zones, and associated number of rain events for
each zone.

**Inputs**

+----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------+
| **Name**             | **Description**                                                                                                                                                                                                                                | **Type**                                                                                               |                   
+======================+================================================================================================================================================================================================================================================+========================================================================================================+
| Climate zone table   | Table with the number of rain events per month and climate zone. Column names: *cz\_id*, representing climate zone numbers, integers found in the Climate zone raster, followed by columns with 3-letter month names, i.e. *jan*,…, *dec*      | .csv table with integers for *cz\_id* and floating point rain event values for *jan* through *dec*     |
+----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------+
| Climate zone         | Map of climate zones, each uniquely identified by an integer                                                                                                                                                                                   | Raster of integers                                                                                     |
+----------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------+--------------------------------------------------------------------------------------------------------+

|
|

The model computes sequentially the local recharge layer, and then the
baseflow layer from local recharge. Instead of InVEST calculating local recharge, this layer could be
obtained from a different model (e.g, RHESSys.) To compute baseflow contribution based on your own recharge layer, it
is possible to bypass the first part of the model and enter directly a map of local recharge.

**Inputs**

+------------------+--------------------------------------------------------------------------+-----------------------------------+
| **Name**         | **Description**                                                          | **Type**                          |
+==================+==========================================================================+===================================+
| Local recharge   | Raster with the local recharge obtained from a different model (in mm)   | Raster of floating point values   |
+------------------+--------------------------------------------------------------------------+-----------------------------------+

|
|

The *alpha* parameter represents the temporal variability in the
contribution of upslope available water to evapotranspiration on a
pixel. In the default parameterization, its value is set to 1/12,
assuming that the soil buffers water release and that the monthly
contribution is exactly 1\\12\ :sup:`th` of the annual contribution.

To allow upslope subsidy to be temporally variable, the user can enter
monthly *alpha* values, in the same table as the rain events
table.

**Inputs**

+---------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------+
| **Name**            | **Description**                                                                                                                                            | **Type**                                            |
+=====================+============================================================================================================================================================+=====================================================+
| Rain events table   | The rain events table is a model input for the default run (see above). One additional column named *alpha* is needed to run this advanced option.         | .csv table with floating point values for *alpha*   |
+---------------------+------------------------------------------------------------------------------------------------------------------------------------------------------------+-----------------------------------------------------+

Running the model
-----------------

To launch the Seasonal Water Yield model navigate to the Windows Start Menu -> All Programs -> InVEST [*version*] -> Seasonal Water Yield. The interface does not require a GIS desktop, although the results will need to be explored with any GIS tool such as ArcGIS or QGIS.


Interpreting outputs
--------------------

The following is a short description of each of the outputs from the Seasonal Water Yield model. Final results are found within the user defined Workspace specified for this model. "Suffix" in the following file names refers to the optional user-defined Suffix input to the model.

 * **Parameter log**: Each time the model is run, a text (.txt) file will be created in the Workspace. The file will list the parameter values and output messages for that run and will be named according to the service, the date and time, and the suffix. When contacting NatCap about errors in a model run, please include the parameter log.
 * **B_[Suffix].tif** (type: raster; units: mm, but should be interpreted as relative values, not absolute): Map of baseflow :math:`B` values, the contribution of a pixel to slow release flow (which is not evapotranspired before it reaches the stream)
 * **B_sum_[Suffix].tif** (type: raster; units: mm): Map of :math:`B_{\text{sum}}`\ values, the flow through a pixel, contributed by all upslope pixels, that is not evapotranspirated before it reaches the stream 
 * **CN_[Suffix].tif** (type: raster): Map of Curve Number values
 * **L_avail_[Suffix].tif** (type: raster; units: mm): Map of available local recharge :math:`L_{\text{avail}}` , i.e. only positive L values 
 * **L_[Suffix].tif** (type: raster; units: mm): Map of local recharge :math:`L` values 
 * **L_sum_avail_[Suffix].tif** (type: raster; units: mm): Map of :math:`L_{\text{sum.avail}}` values, the available water to a pixel, contributed by all upslope pixels, that is available for evapotranspiration by this pixel 
 * **L_sum_[Suffix].tif** (type: raster; units: mm): Map of :math:`L_{\text{sum}}` values, the flow through a pixel, contributed by all upslope pixels, that is available for evapotranspiration to downslope pixels 
 * **QF_[Suffix].tif** (type: raster; units: mm): Map of quickflow (QF) values 
 * **Vri_[Suffix].tif** (type: raster): Map of the values of recharge (contribution, positive or negative), to the total recharge
 * **intermediate_outputs/aet_[Suffix].tif** (type: raster; units: mm): Map of actual evapotranspiration (AET) 
 * **intermediate_outputs/qf_1_[Suffix].tif...qf_12_[Suffix].tif** (type: raster; units: mm): Maps of monthly quickflow (1 = January... 12 = December) 
 * **intermediate_outputs/stream_[Suffix].tif** (type: raster): Stream network generated from the input DEM and Threshold Flow Accumulation. Values of 1 represent streams, values of 0 are non-stream pixels.
 
 
Appendix 1: Data sources and guidance for parameter selection
-------------------------------------------------------------


Monthly precipitation 
^^^^^^^^^^^^^^^^^^^^^  

Global monthly precipitation data can be obtained from the WorldClim dataset: http://www.worldclim.org/   
                                                                                                       
Alternatively, rasters can be interpolated from rain gauge points with monthly data.              
                                                                                                               

Monthly reference evapotranspiration  
^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^

Global monthly reference evapotranspiration may be obtained from the CGIAR CSI dataset (based on WorldClim data): http://www.cgiar-csi.org/data/global-aridity-and-pet-database. 

It is important that the precipitation data used for calculating reference evapotranspiration is the same as the precipitation data used as input to the model.


Digital elevation model
^^^^^^^^^^^^^^^^^^^^^^^                 

DEM data is available for any area of the world, although at varying resolutions. 

Free raw global DEM data is available from:

 *  the World Wildlife Fund - http://worldwildlife.org/pages/hydrosheds
 *  NASA: \ https://asterweb.jpl.nasa.gov/gdem.asp (30m resolution); and easy access to SRTM data: \ http://dwtkns.com/srtm/
 *  USGS: \ https://earthexplorer.usgs.gov/

Alternatively, it may be purchased relatively inexpensively at sites such as MapMart (www.mapmart.com).

The DEM resolution may be a very important parameter depending on the project’s goals. For example, if decision makers need information about impacts of roads on ecosystem services then fine resolution is needed. The hydrological aspects of the DEM used in the model must be correct. Most raw DEM data has errors, so it's likely that the DEM will need to be filled to remove sinks. Multiple passes of the ArcGIS Fill tool, or QGIS Wang & Liu Fill algorithm (SAGA library) have shown good results.


Land use/land cover 
^^^^^^^^^^^^^^^^^^^                    

A key component for all water models is a spatially continuous land use / land cover raster (LULC) grid. That is, within a watershed, all pixels should have a land use / land cover class defined. Gaps in data will create missing data (holes) in the output layers. Unknown data gaps should be approximated. 

Global land use data is available from:

 *  the University of Maryland’s Global Land Cover Facility: \ http://glcf.umd.edu/data/landcover/ (data available in 1 degree, 8km and 1km resolutions).
 *  NASA: \ https://lpdaac.usgs.gov/dataset_discovery/modis/modis_products_table/mcd12q1 (MODIS multi-year global landcover data provided in several classifications)
 *  the European Space Agency: \ https://www.esa-landcover-cci.org (Three global maps for the 2000, 2005 and 2010 epochs) 

Data for the U.S. is provided by the USGS and Department of the Interior via the National Land Cover Database: \ https://www.mrlc.gov/finddata.php

The simplest categorization of LULCs on the landscape involves delineation by land cover only (e.g., cropland, temperate conifer forest, prairie). Several global and regional land cover classifications are available (e.g., Anderson et al. 1976), and often detailed land cover classification has been done for the landscape of interest.

A slightly more sophisticated LULC classification involves breaking relevant LULC types into more meaningful types. For example, agricultural land classes could be broken up into different crop types or forest could be broken up into specific species. The categorization of land use types depends on the model and how much data is available for each of the land types. You should only break up a land use type if it will provide more accuracy in modeling. For instance, only break up ‘crops’ into different crop types if you have information on the difference in evapotranspiration rates (Kc) and soil characteristics (CN) between crop management values.

Soil group
^^^^^^^^^^

Soil groups are determined from hydraulic conductivity and soil depths.

FutureWater has created a global map of hydraulic conductivity available at: http://www.futurewater.eu/2015/07/soil-hydraulic-properties/

To convert hydraulic conductivity to soil hydrologic group, Table 1 below can be used. Otherwise, look for guidance online, e.g.: http://www.bwsr.state.mn.us/outreach/eLINK/Guidance/HSG_guidance.pdf

AOI/ Watershed
^^^^^^^^^^^^^^

To delineate watersheds, users can use the InVEST tool DelineateIT. Watershed creation tools are also provided with GIS software, as well as some hydrology models. It is recommended that you delineate watersheds using the DEM that you are modeling with, so the watershed boundary corresponds correctly to the topography.

Alternatively, a number of watershed maps are available online, e.g. HydroBASINS: http://hydrosheds.org/. Note that if watershed boundaries are not based on the same DEM that is being modeled, results that are aggregated to these watersheds are likely to be inaccurate.

Biophysical table
^^^^^^^^^^^^^^^^^

It is recommended to do a literature search to look for values for CN and Kc that are specific to the area you're working in. If these are not available, look for values that correspond as closely as possible to the same types of land cover/soil/climate. If none of these more local values are available, several general sources are recommended.

 * Curve numbers (fields *CN_A*, *CN_B*, *CN_C*, *CN_D*) can be obtained from the USDA handbook: (NRCS-USDA, 2007 Chap. 9)

 * Monthly Kc values (fields *Kc_1* through *Kc_12*) can be obtained from the FAO guidelines: (Allen et al., 1998)

For water bodies and wetlands that are connected to the stream, CN can be set to 99 (i.e. assuming that those pixels rapidly convey quickflow.)

When the focus is on potential flood effects, CN may be selected to reflect wet antecedent runoff conditions: CN values should then be converted to ARC-III conditions, as per Chap 10 in NRCA-USDA guidelines (2007).

Rain events table
^^^^^^^^^^^^^^^^^

The average number of monthly rain events can be obtained from local climate statistics (Bureau of Meteorology) or online resources:

 * http://www.yr.no/
 * http://wcatlas.iwmi.org
 * The World Bank also provides maps with precipitation statistics: http://data.worldbank.org/developers/climate-data-api

Climate zones are available from: http://koeppen-geiger.vu-wien.ac.at/present.htm

Threshold flow accumulation
^^^^^^^^^^^^^^^^^^^^^^^^^^^             

There is no one "correct" value for the threshold flow accumulation (TFA). The correct value for your application is the value that causes the model to create a stream layer that looks as close as possible to the real-world stream network in the watershed. Compare the model output file *stream.tif* with a known correct stream layer, and adjust the TFA accordingly - larger values of TFA will create a stream network with fewer tributaries, smaller values will create a stream network with more tributaries. Note that generally streams delineated from a DEM do not exactly match, so try to come as close as possible. If the modelled streams are very different, then consider trying a different DEM.

Rule of thumb: contribution area of 1km\ :sup:`2` (threshold needs to be calculated based on pixel area)

A global layer of streams can be obtained from HydroSHEDS: http://hydrosheds.org/

:math:`\alpha_{m}`
^^^^^^^^^^^^^^^^^^                    

Default=1/12. See Appendix 2

:math:`\beta_{i}`
^^^^^^^^^^^^^^^^^

Default=1. See Appendix 2

:math:`\gamma`
^^^^^^^^^^                            

Default =1. See Appendix 2


|
|

**Table 1: Criteria for assignment of hydrologic soil groups (NRCS-USDA,
2007 Chap. 7)**

+----------------------------------------------------------------------------------------------------------------------------------------------------+-------------+----------------+----------------+-----------------------------------------------------------------------+
|                                                                                                                                                    | Group A     | Group B        | Group C        | Group D                                                               |
+====================================================================================================================================================+============-+================+================+=======================================================================+
| Saturated hydraulic conductivity of the least transmissive layer when a water impermeable layer exists at a depth between 50 and 100 centimeters   | >40 μm/s   | [40;10] μm/s  | [10;1] μm/s   | <1 μm/s (or depth to impermeable layer<50cm or water table<60cm)     |
+----------------------------------------------------------------------------------------------------------------------------------------------------+-------------+----------------+----------------+-----------------------------------------------------------------------+
| Saturated hydraulic conductivity of the least transmissive layer when any water impermeable layer exists at a depth greater than 100 centimeters   | >10 μm/s   | [4;10] μm/s   | [0.4;4] μm/s  | <0.4 μm/s                                                            |
+----------------------------------------------------------------------------------------------------------------------------------------------------+-------------+----------------+----------------+-----------------------------------------------------------------------+

|
|
 

Appendix 2: :math:`{\mathbf{\alpha},\mathbf{\beta}}_{\mathbf{i}},`\ and :math:`gamma` parameters definition and alternative values
----------------------------------------------------------------------------------------------------------------------------------

:math:`\alpha` and :math:`\beta_{i}` represent the fraction of annual
recharge from upgradient parcels that is available to a downgradient
pixel for evapotranspiration in a given month. The product
:math:`\alpha \times \beta_{i}` is expected to be <1 since some water
from upslope may be unavailable, either when it follows deep flowpaths
or when the timing of supply and (evapotranspirative) demand is not
right.

:math:`\alpha` is a function of precipitation seasonality: recharge from
a given month can be used by downslope areas during later months,
depending on the subsurface travel times. In the default
parameterization, its value is set to 1/12, assuming that the soil
buffers water release and that the monthly contribution is exactly one
12\ :sup:`th` of the annual contribution. An alternative assumption is
to set values to the antecedent monthly precipitation values, relative
to the total precipitation: P\ :sub:`m-1`/P\ :sub:`annual`

:math:`\beta_{i}` is a function of local topography and soils: for a
given amount of upslope recharge, the amount of water used by a pixel is
a function of the storage capacity. It also depends on the
characteristics of the upslope area: the use of the upgradient subsidy
is conditioned by the shape and area of the contribution area (i.e. the
recharge from the pixel just above the pixel of interest is less likely
to be lost than the pixels much further away)

In the default parameterization, :math:`\beta` is set to 1 for all
pixels. One alternative is be to set :math:`\beta_{i}` as TI, the
topographic wetness index for a pixel, defined as
:math:`ln(\frac{A}{\text{tan}\beta}`) (or other formulation including soil
type and depth).

γ represents the fraction of pixel recharge that is available to
downgradient pixels. It is a function of soil properties and possibly
topography (e.g. with very permeable soils, the value of . In the
default parameterization, γ is constant over the landscape and plays a
role similar to :math:`\alpha`.

In practice
^^^^^^^^^^^

The options above are provided mainly for research purposes. In
practice, we suggest that for highly seasonal climates, alpha should be
set to the antecedent monthly precipitation values, relative to the
total precipitation: P\ :sub:`m-1`/P:sub:`annual`

Then, we offer two options to address the uncertainty around the
parameter values:

1. Verification of actual evapotranspiration with observations

The model outputs the actual evapotranspiration at the annual time
scale: users can adjust parameters to meet observed actual
evapotranspiration (e.g. from MODIS,
http://www.ntsg.umt.edu/project/mod16).

*  If AET\_mod>AET\_obs, the model overpredicts evapotranspiration,
   which can be corrected by: reducing Kc values, or reducing gamma
   values, and/or beta values (so less water is available for each
   pixel).

*  If AET\_mod<AET\_obs, the model underpredicts evapotranspiration,
   which can be corrected by: increasing Kc values (and increasing gamma
   or beta values if they are not at their maximum of 1).

If monthly values of AET are available, a finer calibration can be
performed by changing the seasonal parameter alpha.

2. Ensemble modeling

The model can be run under different assumptions and the outputs
compared to estimate the effect of parameter error. Parameter ranges can
be determined from assumptions about the proportion of upslope subsidy
available to a given pixel; they can be set to the maximum bounds (0 and
1) for preliminary results.


References:
-----------

Allen, R.G., Pereira, L.S., Raes, D., Smith, M., 1998. Crop
evapotranspiration - Guidelines for computing crop water requirements,
FAO Irrigation and drainage paper 56. Rome, Italy.

NRCS-USDA, 2007. National Engineering Handbook. United States Department
of Agriculture,
http://www.nrcs.usda.gov/wps/portal/nrcs/detailfull/national/water/?cid=stelprdb1043063.
